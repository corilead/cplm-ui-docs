(window.webpackJsonp=window.webpackJsonp||[]).push([[46],{"./src/picker/UserPicker/index.less":function(e,t,n){},"./src/picker/UserPicker/index.mdx":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return f}));var a=n("./node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js"),r=n("react"),c=n.n(r),o=n("./node_modules/@mdx-js/react/dist/esm.js"),i=n("./node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),l=n("./node_modules/antd/es/form/index.js"),s=n("./node_modules/antd/es/radio/index.js"),u=n("./node_modules/antd/es/checkbox/index.js"),d=n("./node_modules/antd/es/button/index.js"),m=n("./src/picker/UserPicker/index.tsx"),b=(n("./node_modules/antd/dist/antd.css"),function(e){var t=Object(r.useState)(!1),n=Object(i.a)(t,2),a=n[0],o=n[1],b=Object(r.useState)("tenant"),p=Object(i.a)(b,2),f=p[0],j=p[1],v=Object(r.useState)(!1),O=Object(i.a)(v,2),h=O[0],y=O[1];return c.a.createElement("div",{style:{position:"relative"}},c.a.createElement(l.a,{layout:"inline"},c.a.createElement(l.a.Item,{label:"\u641c\u7d22\u8303\u56f4"},c.a.createElement(s.default.Group,{value:f,onChange:function(e){j(e.target.value)}},c.a.createElement(s.default,{value:"tenant"},"\u672c\u5355\u4f4d"),c.a.createElement(s.default,{value:"platform"},"\u672c\u5355\u4f4d+\u534f\u540c\u5355\u4f4d"))),c.a.createElement(l.a.Item,{label:"\u591a\u9009"},c.a.createElement(u.a,{checked:h,onChange:function(e){y(e.target.checked)}})),c.a.createElement(l.a.Item,null,c.a.createElement(d.a,{type:"primary",onClick:function(){o(!0)}},"\u6253\u5f00\u7528\u6237\u9009\u62e9\u5668"))),c.a.createElement(m.a,{visible:a,title:"\u641c\u7d22\u7528\u6237",scope:f,multi:h,onOk:function(e){console.log("selected users : ",e),o(!1)},onCancel:function(){o(!1)}}))});b&&b===Object(b)&&Object.isExtensible(b)&&Object.defineProperty(b,"__filemeta",{enumerable:!0,configurable:!0,value:{name:"UserPickerDemo",filename:"demo\\UserPicker.tsx"}});var p={};function f(e){var t=e.components,n=Object(a.a)(e,["components"]);return Object(o.b)("wrapper",Object.assign({},p,n,{components:t,mdxType:"MDXLayout"}),Object(o.b)("h2",{id:"demo"},"Demo"),Object(o.b)(b,{mdxType:"UserPickerDemo"}),Object(o.b)("h2",{id:"\u5c5e\u6027"},"\u5c5e\u6027"),Object(o.b)("pre",null,Object(o.b)("code",Object.assign({parentName:"pre"},{}),'  // \u662f\u5426\u53ef\u89c1\n  visible: boolean;\n  // \u6807\u9898\n  title: React.ReactNode;\n  // \u662f\u5426\u53ef\u591a\u9009\n  multi?: boolean;\n  // \u6570\u636e\u9009\u5b9a\u65f6\u7684\u65b9\u6cd5\n  onOk: (selectedUsers: any[]) => void;\n  // \u53d6\u6d88\u6570\u636e\u9009\u5b9a\u7684\u65b9\u6cd5\n  onCancel: Function;\n  // \u70b9\u51fb\u786e\u5b9a\u6309\u94ae\u65f6\u7684\u7b49\u5f85\u72b6\u6001\n  confirmLoading?: boolean;\n  // \u641c\u7d22\u8303\u56f4\u662f\u672c\u79df\u6237\u8fd8\u662f\u5168\u5e73\u53f0\n  scope?: "tenant" | "platform";\n  // \u9644\u52a0\u7684\u7b5b\u9009\u7528\u6237\u7684\u6761\u4ef6\n  extraQuery?: { [param: string]: any };\n')),Object(o.b)("h2",{id:"\u4ee3\u7801"},"\u4ee3\u7801"),Object(o.b)("pre",null,Object(o.b)("code",Object.assign({parentName:"pre"},{}),'import React, { useState } from "react";\nimport { Form, Radio, Checkbox, Button } from "antd";\nimport UserPicker from "../src/picker/UserPicker";\nimport "antd/dist/antd.css";\n\nconst UserPickerDemo: React.FunctionComponent = (props) => {\n  const [pickerVisible, setpickerVisible] = useState(false);\n  const [scope, setscope]: [\n    "tenant" | "platform" | undefined,\n    React.Dispatch<React.SetStateAction<"tenant" | "platform" | undefined>>,\n  ] = useState("tenant");\n  const [multi, setmulti] = useState(false);\n  return (\n    <div style={{ position: "relative" }}>\n      <Form layout="inline">\n        <Form.Item label="\u641c\u7d22\u8303\u56f4">\n          <Radio.Group\n            value={scope}\n            onChange={(e) => {\n              setscope(e.target.value);\n            }}\n          >\n            <Radio value="tenant">\u672c\u5355\u4f4d</Radio>\n            <Radio value="platform">\u672c\u5355\u4f4d+\u534f\u540c\u5355\u4f4d</Radio>\n          </Radio.Group>\n        </Form.Item>\n        <Form.Item label="\u591a\u9009">\n          <Checkbox\n            checked={multi}\n            onChange={(e) => {\n              setmulti(e.target.checked);\n            }}\n          />\n        </Form.Item>\n        <Form.Item>\n          <Button\n            type="primary"\n            onClick={() => {\n              setpickerVisible(true);\n            }}\n          >\n            \u6253\u5f00\u7528\u6237\u9009\u62e9\u5668\n          </Button>\n        </Form.Item>\n      </Form>\n      <UserPicker\n        visible={pickerVisible}\n        title="\u641c\u7d22\u7528\u6237"\n        scope={scope}\n        multi={multi}\n        onOk={(rows: any[]) => {\n          // tslint:disable-next-line: no-console\n          console.log("selected users : ", rows);\n          setpickerVisible(false);\n        }}\n        onCancel={() => {\n          setpickerVisible(false);\n        }}\n      />\n    </div>\n  );\n};\n\nexport { UserPickerDemo };\n')))}f&&f===Object(f)&&Object.isExtensible(f)&&Object.defineProperty(f,"__filemeta",{enumerable:!0,configurable:!0,value:{name:"MDXContent",filename:"src\\picker\\UserPicker\\index.mdx"}}),f.isMDXComponent=!0},"./src/picker/UserPicker/index.tsx":function(e,t,n){"use strict";var a=n("./node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),r=n("./node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),c=n("./node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator/index.js"),o=n.n(c),i=n("./node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),l=n("react"),s=n.n(l),u=n("./node_modules/@ant-design/icons/es/icons/EnvironmentOutlined.js"),d=n("./node_modules/@ant-design/icons/es/icons/HomeOutlined.js"),m=n("./node_modules/@ant-design/icons/es/icons/SoundOutlined.js"),b=n("./node_modules/@ant-design/icons/es/icons/SearchOutlined.js"),p=n("./node_modules/@ant-design/icons/es/icons/ReloadOutlined.js"),f=n("./node_modules/antd/es/tag/index.js"),j=n("./node_modules/antd/es/divider/index.js"),v=n("./node_modules/antd/es/tree-select/index.js"),O=n("./node_modules/antd/es/tree/index.js"),h=n("./node_modules/antd/es/layout/index.js"),y=n("./node_modules/antd/es/card/index.js"),k=n("./node_modules/antd/es/space/index.js"),g=n("./node_modules/antd/es/input/index.js"),x=n("./node_modules/antd/es/button/index.js"),E=n("./node_modules/antd/es/table/index.js"),_=n("./src/display/index.tsx"),S=n("./node_modules/qs/lib/index.js"),w=n("./node_modules/@cpdm/util/es/index.js"),C=n("./src/picker/utils.ts"),P=(n("./src/picker/UserPicker/index.less"),{"\u975e\u5bc6":"#65bdfb","\u4e00\u822c":"#257af9","\u91cd\u8981":"#0748ab"}),I=sessionStorage.getItem("TEST_SVR")||"",F=function(){var e=Object(i.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(w.a)("".concat(I,"/plm/api/v2/cpdm/users").concat(Object(S.stringify)(t,{addQueryPrefix:!0}))));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),U=function(){var e=Object(i.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(w.a)("".concat(I,"/plm/api/v2/cpdm/suppliers")));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),R=function(){var e=Object(i.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(w.a)("".concat(I,"/plm/api/v2/cpdm/departments?tenantId=").concat(t||"")));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),A=[{title:"\u7528\u6237\u5168\u540d",dataIndex:"fullName",ellipsis:!0,key:"fullName",render:function(e,t){return s.a.createElement(s.a.Fragment,null,s.a.createElement(f.a,{color:P[t.secretLevel]},t.secretLevel),e)}},{title:"\u7528\u6237\u540d",dataIndex:"username",ellipsis:!0,key:"username"},{title:"\u90ae\u7bb1",dataIndex:"email",ellipsis:!0,key:"email"}],D=function e(t){return null===t||void 0===t?void 0:t.map((function(t){return Object(r.a)(Object(r.a)({},t),{},{key:t.id,title:s.a.createElement(s.a.Fragment,null,t.name,t.shortName?s.a.createElement(s.a.Fragment,null,s.a.createElement(j.a,{type:"vertical"}),t.shortName):""),children:e(t.children)})}))},N=function(e){var t=!1,n=e.visible,c=e.title,S=e.multi,w=e.onOk,I=e.onCancel,N=e.scope,L=void 0===N?"tenant":N,T=e.confirmLoading,V=e.extraQuery,z=Object(l.useState)(),B=Object(a.a)(z,2),G=B[0],M=B[1],K=Object(l.useState)([]),Q=Object(a.a)(K,2),W=Q[0],X=Q[1],H=Object(l.useState)({content:[],pagination:{}}),J=Object(a.a)(H,2),q=J[0],Y=J[1],Z=Object(l.useState)([]),$=Object(a.a)(Z,2),ee=$[0],te=$[1],ne=Object(l.useState)(!1),ae=Object(a.a)(ne,2),re=ae[0],ce=ae[1],oe=Object(l.useState)({}),ie=Object(a.a)(oe,2),le=ie[0],se=ie[1],ue=Object(l.useState)(),de=Object(a.a)(ue,2),me=de[0],be=de[1],pe=Object(l.useState)(),fe=Object(a.a)(pe,2),je=fe[0],ve=fe[1],Oe=Object(l.useCallback)(function(){var e=Object(i.a)(o.a.mark((function e(n,a,c){var i,l,s=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=s.length>3&&void 0!==s[3]?s[3]:{current:1,pageSize:10},s.length>4?s[4]:void 0,s.length>5?s[5]:void 0,s.length>6?s[6]:void 0,t||ce(!0),e.next=7,F(Object(r.a)({tenantId:n,departmentId:a,keyword:c,page:i.current-1,size:i.pageSize},V));case 7:(l=e.sent)&&l.content&&Array.isArray(l.content)&&!t&&Y({content:l.content,pagination:{current:l.number+1,pageSize:l.size,total:l.totalElements,showTotal:function(e){return"\u5171".concat(e,"\u9879")}}}),t||ce(!1);case 10:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),[V]),he=Object(l.useCallback)(Object(i.a)(o.a.mark((function e(){var n,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,U();case 2:(n=e.sent)&&Array.isArray(n)&&(a={},n.forEach((function(e){e.id&&(a[e.id]=e)})),t||se(a));case 4:case"end":return e.stop()}}),e)}))),[]),ye=Object(l.useCallback)(function(){var e=Object(i.a)(o.a.mark((function e(n){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,R(n);case 2:(a=e.sent)&&Array.isArray(a)&&!t&&X(a);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[]),ke=Object(l.useCallback)((function(){Oe(me,je,G)}),[me,je,G]),ge=Object(l.useCallback)((function(){M(void 0),Oe(me,je,void 0)}),[me,je]),xe=Object(l.useCallback)((function(e,t){te(Object(C.a)(e,t,ee,S))}),[ee]),Ee=Object(l.useCallback)((function(e,t,n){te(Object(C.b)(e,n,ee))}),[ee]),_e=function(e,t){var n=Object(a.a)(e,1)[0];ve(n),Oe(me,n,G)};Object(l.useEffect)((function(){return ye(),he(),Oe(void 0,void 0,void 0),function(){t=!0}}),[]);var Se,we,Ce,Pe=s.a.createElement(s.a.Fragment,null,c,"platform"===L&&s.a.createElement(v.a,{placeholder:"\u641c\u7d22\u8303\u56f4",treeIcon:!0,defaultValue:"tenant",treeDefaultExpandAll:!0,dropdownMatchSelectWidth:!1,treeData:[{value:"tenant",title:"\u672c\u5355\u4f4d",icon:s.a.createElement(d.a,{style:{color:"blue"}})},{value:"colla",title:"\u534f\u540c\u5355\u4f4d",icon:s.a.createElement(m.a,{style:{color:"green"}}),selectable:!1,children:(Se=le,we=Object(r.a)({},Se),Ce=[],Object.keys(we).forEach((function(e){var t=we[e],n=(t=Object(r.a)(Object(r.a)({},t),{},{value:t.id,title:s.a.createElement(s.a.Fragment,null,t.name,t.shortName?s.a.createElement(s.a.Fragment,null,s.a.createElement(j.a,{type:"vertical"}),t.shortName):""),icon:s.a.createElement(u.a,{style:{color:"green"}})})).parentId;if(n&&"0"!==n){var a=we[n];a&&(a.children=a.children||[],a.children.push(t))}else Ce.push(t)})),Ce)}],style:{width:300,marginLeft:16},onChange:function(e){if(e&&"tenant"!==e){var t=le[e],n=null===t||void 0===t?void 0:t.tenantId;n?(be(n),ve(void 0),ye(n),Oe(n,void 0,G)):(Y({content:[],pagination:{}}),X([]))}else be(void 0),ve(void 0),Oe(void 0,void 0,G),ye()}})),Ie=s.a.useCallback((function(t){return s.a.createElement(O.a,Object.assign({},e,{defaultExpandAll:!0,showLine:!0,treeData:D(t.treeData),onSelect:_e,selectedKeys:je?[je]:[]}))}),[me]),Fe=s.a.createElement(h.a,{style:{backgroundColor:"transparent"}},s.a.createElement(h.a.Sider,{theme:"light",width:320},s.a.createElement(y.a,{bordered:!0,bodyStyle:{height:520,overflow:"auto",padding:6}},s.a.createElement(Ie,{treeData:W}))),s.a.createElement(h.a.Content,null,s.a.createElement("div",{style:{marginLeft:12}},s.a.createElement(k.a,{size:"small",style:{marginBottom:12}},s.a.createElement(g.a,{style:{width:488},placeholder:"\u8f93\u5165\u7528\u6237\u540d/\u7528\u6237\u5168\u540d/\u90ae\u7bb1\u8fdb\u884c\u68c0\u7d22",value:G,onChange:function(e){M(e.target.value)}}),s.a.createElement(x.a,{icon:s.a.createElement(b.a,null),type:"primary",onClick:ke,disabled:T},"\u68c0\u7d22"),s.a.createElement(x.a,{icon:s.a.createElement(p.a,null),onClick:ge,disabled:T},"\u91cd\u7f6e")),s.a.createElement(E.a,{columns:A,dataSource:q.content,pagination:q.pagination,onChange:function(e,t,n,a){Oe(me,je,G,e,t,n,a)},size:"small",bordered:!0,loading:re,rowSelection:{columnWidth:30,selectedRowKeys:ee.map((function(e){return e.id})),type:S?"checkbox":"radio",onSelect:xe,onSelectAll:Ee,fixed:!0},rowKey:function(e){return e.id}}))));return s.a.createElement(_.f,{visible:n,confirmLoading:T,width:1024,title:Pe,bodyStyle:{padding:12},onOk:function(){w(ee)},onCancel:function(){I()}},s.a.createElement("div",{title:"\u5df2\u9009\u7528\u6237",className:"selected-area",style:S&&ee&&ee.length?{}:{display:"none"}},ee.map((function(e){return s.a.createElement(f.a,{closable:!0,color:P[e.secretLevel],key:e.id,onClose:function(){xe(e,!1)}},e.fullName)}))),Fe)};t.a=N,N&&N===Object(N)&&Object.isExtensible(N)&&Object.defineProperty(N,"__filemeta",{enumerable:!0,configurable:!0,value:{name:"UserPicker",filename:"src\\picker\\UserPicker\\index.tsx"}})},"./src/picker/utils.ts":function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return o}));var a=n("./node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),r=n("./node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js"),c=function(e,t,n,c){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"id";if(t){var i,l=!1,s=Object(r.a)(n);try{for(s.s();!(i=s.n()).done;)if(i.value[o]===e[o]){l=!0;break}}catch(b){s.e(b)}finally{s.f()}if(!l)return c?[].concat(Object(a.a)(n),[e]):[e]}else{var u,d=0,m=Object(r.a)(n);try{for(m.s();!(u=m.n()).done;){if(u.value[o]===e[o])return c?(n.splice(d,1),Object(a.a)(n)):[e];d++}}catch(b){m.e(b)}finally{m.f()}}return n};"undefined"!==typeof c&&c&&c===Object(c)&&Object.isExtensible(c)&&Object.defineProperty(c,"__filemeta",{enumerable:!0,configurable:!0,value:{name:"select",filename:"src\\picker\\utils.ts"}});var o=function(e,t,n){var c,o,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"id",l=Object(r.a)(t);try{for(l.s();!(o=l.n()).done;)if(c=o.value,e){var s,u=!1,d=Object(r.a)(n);try{for(d.s();!(s=d.n()).done;)if(s.value[i]===c[i]){u=!0;break}}catch(f){d.e(f)}finally{d.f()}u||n.push(c)}else{var m,b=0,p=Object(r.a)(n);try{for(p.s();!(m=p.n()).done;){if(m.value[i]===c[i]){n.splice(b,1);break}b++}}catch(f){p.e(f)}finally{p.f()}}}catch(f){l.e(f)}finally{l.f()}return Object(a.a)(n)};"undefined"!==typeof o&&o&&o===Object(o)&&Object.isExtensible(o)&&Object.defineProperty(o,"__filemeta",{enumerable:!0,configurable:!0,value:{name:"selectAll",filename:"src\\picker\\utils.ts"}})}}]);